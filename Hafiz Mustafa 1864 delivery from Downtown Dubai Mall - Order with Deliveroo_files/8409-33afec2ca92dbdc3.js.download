(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8409],{82042:function(e,t,o){"use strict";o.d(t,{fk:function(){return s},sO:function(){return a},wT:function(){return r}});var n=o(5116);function a(e){var t=e.email,o=e.coordinates,a=e.post_code;return function(e,r){var s=r().request;return e({type:n.Szh,endpoint:"/orderapp/v1/coverage/requests",options:{method:"POST",body:{tld:s.country.tld,email:t,coordinates:o,post_code:a}}})}}function r(){return{type:n.nnx}}function s(){return{type:n.XQV}}},8409:function(e,t,o){"use strict";o.r(t),o.d(t,{LocationSearchContainer:function(){return eT},MAXIMUM_SAVED_ADDRESSES:function(){return ew},default:function(){return eO}});var n=o(54300),a=o(23842),r=o(24364),s=o(21151),i=o(17599),c=o(17538),d=o(85034),l=o(70169),u=o(5341),p=o(84457),g=o(95827),h=o(24246),f=o(27378),m=o(23615),S=o.n(m),v=o(37222),b=o(37254),L=o(22741),A=o.n(L),M=o(87721),Z=o.n(M),C=o(45439),R=o.n(C),x=o(80899),k=o.n(x),y=o(89252),w=o(24043),T=o(10277),P=o(63558),F=o(14275),B=o(13984),E=o(70381),O=o(25419),N=o(50199),j=o.n(N),V=o(17119),q=o(23203),I=o.n(q),D=o(72639),_=o.n(D),U=o(78876),W=o.n(U),G=o(9125),H=o(12385),K=o(14036),z=o(37384),Q=o(13118),X=o(93500),Y=o(97898),$=o.n(Y),J=function(e){var t=e.hasGeolocation,o=e.value,n=e.placeholder,a=e.searchFilterMessage,r=e.locateButtonLabel,s=e.loginMessageTemplate,i=e.loginUrl,c=e.savedAddresses,u=e.savedAddressLoadingId,p=e.savedAddressesCaption,g=e.onFocus,m=e.onBlur,S=e.onAddressClick,v=e.onLocateClick,b=e.onSubmit,L=e.onChange,A=e.onKeyDown,M=e.isLocating,Z=e.suggestions,C=e.highlightedSuggestion,R=e.onSuggestionClick,x=e.inputRef,k=e.containerRef,y=e.onModalClose,T=e.onClear,P=a?(0,h.jsx)(w.default,{size:"x-small",color:"grey",spacing:"small 0",children:a}):null,F=s?(0,h.jsx)(w.default,{size:"small",color:"grey",adjacentVerticalSpacing:"medium",children:(0,h.jsx)(z.default,{template:s,render:function(e){var t=e.linkText;return(0,h.jsx)("a",{href:i,className:$().login,children:t})}})}):null;return(0,h.jsxs)("div",{className:$().modalContentWrapper,ref:k,children:[(0,h.jsxs)("div",{className:$().inputWrapper,children:[(0,h.jsx)(Q.default,{spacing:"0 0 0 small",onClick:y,shouldInvertKeyboardFocusOutline:!0,children:(0,h.jsx)(G.default,{component:I(),color:"primary-action"})}),(0,h.jsx)("form",{className:$().searchForm,action:".",onSubmit:function(e){e.preventDefault(),b(e)},children:(0,h.jsx)("input",{type:"search",className:$().searchInput,id:"modal-location-search",name:"modal-location-search",placeholder:n,onChange:L,value:o,autoComplete:"off",ref:x,onKeyDown:A,onFocus:g,onBlur:m})}),o&&T?(0,h.jsx)("button",{type:"button",className:$().inputButton,onClick:T,children:(0,h.jsx)(G.default,{component:W(),color:"light-grey"})}):t?(0,h.jsx)("button",{"aria-label":r,type:"button",onClick:v,className:$().inputButton,children:M?(0,h.jsx)(X.default,{}):(0,h.jsx)(G.default,{component:_(),color:"primary-action"})}):null]}),Boolean(Z.length)&&(0,h.jsxs)("div",{className:$().suggestions,children:[(0,h.jsx)("ul",{children:Z.map(function(e,t){var o=e.placeId,n=e.address,a=e.locality;return(0,h.jsx)(H.default,{address:n,locality:a,isHighlighted:t===C,onClick:function(){return R(o)}},o)})}),(0,h.jsx)("div",{className:$().poweredByGoogle,title:"Powered by Google"})]}),(0,h.jsxs)("div",{className:$().savedAddressesContainer,children:[Boolean(c.length)&&!Z.length&&(0,h.jsxs)(f.Fragment,{children:[Boolean(p)&&(0,h.jsx)(w.default,{color:"grey",size:"small",children:p}),(0,h.jsx)("ul",{className:$().savedAddressList,children:c.map(function(e){var t;return(0,h.jsx)(K.default,(0,l.Z)((0,d.Z)({},e),{isLoading:u===e.id,onClick:function(t){t.preventDefault(),S(e)}}),e.id)})})]}),!Z.length&&!F&&P,!Z.length&&F]})]})};J.propTypes={hasGeolocation:S().bool,value:S().string.isRequired,placeholder:S().string.isRequired,searchFilterMessage:S().string,locateButtonLabel:S().string,loginMessageTemplate:S().string,loginUrl:(0,v.default)(S().string,function(e){return!!e.loginMessageTemplate}),savedAddresses:S().arrayOf(S().shape({id:S().string,formattedAddress:S().string,postcode:S().string,coordinates:S().arrayOf(S().number).isRequired})),savedAddressLoadingId:S().string,savedAddressesCaption:(0,v.default)(S().string,function(e){return!!e.savedAddresses.length}),onFocus:S().func,onBlur:S().func,onChange:S().func.isRequired,onKeyDown:S().func,onLocateClick:S().func.isRequired,onSubmit:S().func.isRequired,onAddressClick:S().func,onModalClose:S().func.isRequired,onClear:S().func,isLocating:S().bool,suggestions:S().arrayOf(S().shape({placeId:S().string.isRequired,address:S().string.isRequired,locality:S().string})),highlightedSuggestion:S().number,onSuggestionClick:S().func.isRequired,inputRef:S().func,containerRef:S().func},J.defaultProps={hasGeolocation:!1,searchFilterMessage:void 0,locateButtonLabel:"",loginMessageTemplate:void 0,loginUrl:void 0,savedAddresses:[],savedAddressLoadingId:void 0,savedAddressesCaption:void 0,onKeyDown:function(){},onFocus:function(){},onBlur:function(){},onAddressClick:function(){},onClear:function(){},isLocating:!1,suggestions:[],highlightedSuggestion:void 0,inputRef:void 0,containerRef:void 0};var ee=o(82042),et=o(70163),eo=o(20888),en=o(7258),ea=o(88719),er=o(10899),es=o(86801),ei=o(39464),ec=o(10490),ed=o(10941),el=function(e){var t=e.appElement,o=e.heading,n=e.body,a=e.closeButtonLabel,r=e.actionButtonLabel,s=e.isOpen,i=e.onClose;return(0,h.jsxs)(ed.default,{appElement:void 0===t?"#__next":t,isOpen:s,onClose:i,closeButtonLabel:a,type:"dialog",renderFooter:function(){return(0,h.jsx)(T.default,{type:"primary",isBlock:!0,onClick:i,children:r})},children:[(0,h.jsx)(ec.default,{level:4,size:"small",children:o}),(0,h.jsx)(w.default,{adjacentVerticalSpacing:"medium",children:n})]})};function eu(e){var t=e.isOpen,o=e.onClose,n=e.isPostcodeSearch,a=e.brandName,r=e.postcode,s=n&&r?r:null;return(0,h.jsx)(el,{isOpen:t,onClose:o,closeButtonLabel:O.Z.gettext("closeButton.label"),actionButtonLabel:O.Z.gettext("landingPage.brand.undeliverableModal.actionButtonLabel"),heading:s?O.Z.gettext("landingPage.brand.undeliverableModal.heading(%(brandName)s, %(location)s)",{brandName:a,location:s}):O.Z.gettext("Sorry, we don't deliver there"),body:O.Z.gettext("landingPage.brand.undeliverableModal.body(%(brandName)s)",{brandName:a})})}eu.propTypes={isOpen:S().bool.isRequired,onClose:S().func.isRequired,isPostcodeSearch:S().bool.isRequired,brandName:S().string.isRequired,postcode:(0,v.default)(S().string,function(e){return!0===e.isPostcodeSearch})},eu.defaultProps={postcode:void 0};var ep=function(e){var t=e.request.country.postcodeSearch,o=e.location.search,n=o.showUndeliverableModal,a=(o.query||{}).postcode;return{isOpen:Boolean(n),isPostcodeSearch:t,postcode:a}},eg=function(e){return{onClose:function(){return e((0,en.fd)())}}},eh=(0,b.$j)(ep,eg)(eu),ef=o(60042),em=o.n(ef),eS=o(93746),ev=o(48795),eb=o(66926),eL=o.n(eb),eA=function(e){(0,c.Z)(o,e);var t=(0,p.Z)(o);function o(){var e;return(0,r.Z)(this,o),e=t.apply(this,arguments),e.state={email:""},e.emailInputChange=function(t){var o=t.target.value;e.setState({email:o})},e.submitForm=function(t){t.preventDefault(),e.props.onSubmit(e.state.email)},e}return o.prototype.render=function(){var e=this.props,t=e.appElement,n=e.errorMessage,a=e.isSubmitted,r=e.heading,s=e.inputLabel,c=e.inputPlaceholder,d=e.ctaLabel,l=e.confirmationMessage,u=e.genericErrorMessage,p=e.isOpen,g=e.onClose,m=this.state.email;return p?(0,h.jsx)(ed.default,{isOpen:!0,appElement:null!=t?t:o.defaultProps.appElement,onClose:g,closeButtonLabel:O.Z.gettext("closeButton.label"),type:"fullscreen",headerTitle:r,children:(0,h.jsx)("div",{className:em()(eL().wrapper,(0,i.Z)({},eL().submitted,a)),children:(0,h.jsxs)("form",{onSubmit:this.submitForm,children:[(0,h.jsx)("div",{className:eL().rider,children:(0,h.jsx)(ev.default,{name:"rider-bicycle",size:88})}),!a&&(0,h.jsxs)(f.Fragment,{children:[(0,h.jsx)(eS.default,{id:"vote-area-email-input",type:"email",name:"email",adjacentVerticalSpacing:"medium",value:m,label:s,placeholder:c,isInvalid:!!n,errorMessage:n||u,onChange:this.emailInputChange}),(0,h.jsx)(T.default,{adjacentVerticalSpacing:"medium",shouldSubmit:!0,isBlock:!0,children:d})]}),a&&(0,h.jsx)(w.default,{adjacentVerticalSpacing:"medium",children:(0,h.jsx)("span",{className:eL().confirmation,children:l})})]})})}):null},o}(f.Component);eA.defaultProps={appElement:"#__next",isSubmitted:!1,errorMessage:void 0,genericErrorMessage:"",inputPlaceholder:"",confirmationMessage:""};var eM=o(4689),eZ=function(e){(0,c.Z)(o,e);var t=(0,p.Z)(o);function o(e){var a;return(0,r.Z)(this,o),a=t.call(this,e),(0,i.Z)((0,n.Z)(a),"onSubmit",function(e){var t=a.props,o=t.postCode,n=t.lat,r=t.lng;a.state.isSubmitted||(""===e?a.setState({errorMessage:O.Z.gettext("locationSearch.voteArea.error.blankEmail")}):a.props.submitArea({post_code:o,coordinates:[r,n],email:e}))}),(0,i.Z)((0,n.Z)(a),"fireEvent",function(){var e=a.props,t=e.page,o=e.postCode,n=e.formattedAddress,r=e.lat,s=e.lng,i=e.whiteLabelConfig,c=n||o;a.props.trackAddressNotDeliverable({action:"Viewed",sourceView:t,searchString:c,postCode:o,lat:r,lng:s}),i&&eM.T1(c)}),a.state={isSubmitted:e.isSubmitted,errorMessage:e.errorMessage},a}return(0,s.Z)(o,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.state,o=t.isSubmitted,n=t.errorMessage;e.isSubmitted&&e.isSubmitted!==o?this.setState({isSubmitted:e.isSubmitted,errorMessage:null}):e.errorMessage&&e.errorMessage!==n&&this.setState({errorMessage:e.errorMessage}),e.isOpen&&!this.props.isOpen&&this.fireEvent()}},{key:"render",value:function(){var e=this.props,t=e.isOpen,o=e.onClose,n=this.state,a=n.errorMessage,r=n.isSubmitted,s={ctaLabel:O.Z.gettext("locationSearch.voteArea.ctaButton"),heading:O.Z.gettext("locationSearch.voteArea.heading"),inputLabel:O.Z.gettext("locationSearch.voteArea.label"),inputPlaceholder:O.Z.gettext("locationSearch.voteArea.email.placeholder"),confirmationMessage:O.Z.gettext("locationSearch.voteArea.confirmationMessage"),genericErrorMessage:O.Z.gettext("locationSearch.voteArea.error.email")};return(0,h.jsx)(eA,(0,d.Z)({isOpen:t,onClose:o,onSubmit:this.onSubmit,errorMessage:a,isSubmitted:r},s))}}]),o}(f.Component);eZ.propTypes={isSubmitted:S().bool,errorMessage:S().string,isOpen:S().bool.isRequired,onClose:S().func.isRequired,page:S().string,postCode:S().string,formattedAddress:S().string,lat:S().number,lng:S().number,trackAddressNotDeliverable:S().func.isRequired,submitArea:S().func.isRequired,whiteLabelConfig:S().oneOfType([S().bool,S().object]).isRequired},eZ.defaultProps={isSubmitted:!1,errorMessage:void 0,page:"",postCode:void 0,formattedAddress:void 0,lat:void 0,lng:void 0};var eC=function(e){var t=e.location.search,o=t.post_code,n=t.formatted_address,a=t.lat,r=t.lng,s=t.showVoteAreaModal,i=e.voteArea,c=i.submitted,d=i.error;return{isOpen:s,postCode:o,formattedAddress:n,lat:a,lng:r,isSubmitted:c,errorMessage:d&&d.message}},eR=function(e){return{submitArea:function(t){return e((0,ee.sO)(t))},trackAddressNotDeliverable:function(t){return e((0,ea.T1)(t))},onClose:function(){return e((0,ee.fk)())}}},ex=(0,b.$j)(eC,eR)((0,y.Z)(eZ)),ek=o(51135),ey=o.n(ek),ew=4,eT=function(e){(0,c.Z)(o,e);var t=(0,p.Z)(o);function o(e){(0,r.Z)(this,o),s=t.call(this,e),(0,i.Z)((0,n.Z)(s),"onMapMarkerChange",function(e){return function(t){var o={coords:{latitude:t.latLng.lat(),longitude:t.latLng.lng()}};s.setState({isLoading:!0}),s.props.locationFromGeolocation({position:o,source:"map",sourceView:window.location.href}).then(function(){s.props.isNewAddressFlow||e.panTo(t.latLng),s.setState({isLoading:!1})})}}),(0,i.Z)((0,n.Z)(s),"onRequestGeolocation",function(){s.setState({isLocating:!0});var e=function(e){s.onClear(),s.props.locationFromGeolocation({position:e,sourceView:window.location.href}).then(function(){s.props.isNewAddressFlow&&(s.setState({isMapOpen:!0}),s.trackAddressRefineViewed())}),s.setState({isLocating:!1})},t=function(){s.setState({isLocating:!1})};navigator.geolocation.getCurrentPosition(e,t,{timeout:3e4})}),(0,i.Z)((0,n.Z)(s),"onFocus",function(){s.props.focusLocationSearch(),Z()(s.props.trackEnteredLocation)}),(0,i.Z)((0,n.Z)(s),"onBlur",function(){(0,s.props.onBlurSearch)()}),(0,i.Z)((0,n.Z)(s),"onClear",function(){s.setState({inputValue:""}),s.props.clearLocationQuery(),s.setState({isValidPostcode:void 0,errorMessage:void 0})}),(0,i.Z)((0,n.Z)(s),"onChange",function(e){var t=s.props.isPostcodeSearch,o=s.state.isValidPostcode,n=e.target.value;switch(s.setState({inputValue:n}),s.searchedTerm||s.props.trackPlacesSuggestions({action:"Started",sourceView:s.props.trackingPage}),s.searchedTerm=n,!0){case""===n:s.props.clearLocationQuery(),s.setState({isValidPostcode:void 0,errorMessage:void 0});break;case t&&!1===o:s.validatePostcode();break;case!t:s.props.fetchAddressSuggestions({searchString:n})}}),(0,i.Z)((0,n.Z)(s),"searchRestaurants",function(){var e=s.getLocationDetails();s.props.locationRestaurantSearch({location:e})}),(0,i.Z)((0,n.Z)(s),"navigateToRedirectUrl",function(){var e=s.props,t=e.searchType,o=e.restaurantsRedirectLocation,n=e.menuRedirectLocation,a=e.onSearch,r=s.state.errorMessage,i="brand"===t?n:o;if(i){if(s.trackRedirectEvent(i),a){a(i);return}window.location.href=i}s.finishLoading({isMapOpen:!1},1e3),r||s.props.hideLocationSearchModal()}),(0,i.Z)((0,n.Z)(s),"onSavedAddressClick",function(e){var t=e.id,o=e.post_code,n=e.coordinates,a=s.props,r=a.searchType,i=a.searchFilter,c=a.brand;s.setState({loadingAddressId:t}),s.trackSearchEvent({postcode:o,lat:n[1],lng:n[0]}),s.props.navigateToSavedAddress({id:t,searchType:r,filter:i,brand:c}).then(s.navigateToRedirectUrl)}),(0,i.Z)((0,n.Z)(s),"onKeyDown",function(e){var t=s.props,o=t.isPostcodeSearch,n=t.highlightedSuggestion,a=t.suggestions;switch(e.key){case"Enter":if(e.preventDefault(),!o&&n>=0){var r=(a[n]||{}).placeId;r&&s.onSuggestionClick(r)}else s.onSubmit(e);break;case"ArrowUp":if(!o&&(e.preventDefault(),n&&n>0)){var i=n-1,c=(a[i]||{}).formattedAddress;s.props.changeHighlightedSuggestion({newSuggestion:i}),c&&s.setState({inputValue:c})}break;case"ArrowDown":if(!o&&(e.preventDefault(),void 0===n||n<a.length-1)){var d=(void 0===n?-1:n)+1,l=(a[d]||{}).formattedAddress;s.props.changeHighlightedSuggestion({newSuggestion:d}),l&&s.setState({inputValue:l})}}}),(0,i.Z)((0,n.Z)(s),"onSuggestionClick",function(e){s.props.selectAddressSuggestion({placeId:e}).then(function(){s.props.trackPlacesSuggestions({action:"Completed",sourceView:s.props.trackingPage}),("basket"!==s.props.searchType||!1!==s.validateAddress())&&s.handleLocationSearch()}),s.props.clearAddressSuggestions(),s.setState({errorMessage:void 0})}),(0,i.Z)((0,n.Z)(s),"onMapClose",function(){s.setState({isMapOpen:!1})}),(0,i.Z)((0,n.Z)(s),"onModalClose",function(){var e=s.props.initialInputValue,t=s.state.isMapOpen,o={};t&&(o={inputValue:e}),s.setState((0,d.Z)({isMapOpen:!1},o),s.props.hideLocationSearchModal)}),(0,i.Z)((0,n.Z)(s),"trackSearchEvent",function(e){var t=e.postcode,o=e.lat,n=e.lng,a=s.props.trackingPage;s.props.trackSearchLocationChange({sourceView:a,postCode:t,lat:o,lng:n})}),(0,i.Z)((0,n.Z)(s),"trackRedirectEvent",function(e){return s.props.trackLocationSearchRedirect(s.searchedTerm,e)}),(0,i.Z)((0,n.Z)(s),"finishLoading",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;window.setTimeout(function(){s.setState((0,d.Z)({loadingAddressId:void 0,isLoading:!1},e))},t)}),(0,i.Z)((0,n.Z)(s),"getLocationDetails",function(){var e,t=s.props,o=t.isPostcodeSearch,n=t.placeId,a=t.formattedAddress,r=t.coords,i=s.state,c=i.inputValue,d=i.pinRefined;if(o)e={post_code:c,confirmed_on_map:!1};else{var l=r||{},u=l.lat,p=l.lng;e={place_id:n,formatted_address:a,coordinates:[p,u],lat:u,lng:p,pin_refined:d}}return e}),(0,i.Z)((0,n.Z)(s),"validatePostcode",function(){var e=s.props.tld,t=s.state.inputValue,o=(0,V.U)(t,e);return s.setState({isValidPostcode:o,errorMessage:!1===o?O.Z.gettext("locationSearch.error.invalid_postcode"):void 0}),o||(s.setState({isMapOpen:!1}),s.inputElement.focus()),o}),(0,i.Z)((0,n.Z)(s),"validateAddress",function(){var e=s.props,t=e.isPostcodeSearch,o=e.suggestions,n=e.coords,a=e.isLocationAccurate,r=e.isNewAddressFlow,i=s.state,c=i.inputValue,d=i.isMapOpen;if(!c)return!1;if(r&&!t)return!!d&&!!n||(s.props.geocodeAddressFromString({searchString:c}).then(function(){s.setState({isMapOpen:!0,isLoading:!1}),s.trackAddressRefineViewed()}),!1);if(t){var l=s.validatePostcode();return!!l&&!!n&&!!a||(l&&n?(s.setState({isMapOpen:!0}),s.trackAddressRefineViewed(),!1):l)}return o.length>1?(s.setState({errorMessage:O.Z.gettext("locationSearch.error.autocomplete_not_selected")}),!1):1===o.length&&c===o[0].formattedAddress?(s.props.geocodeAddressFromString({searchString:c}).then(function(){s.props.clearAddressSuggestions(),s.onSubmit()}),!1):!a&&n?(s.setState({isMapOpen:!0}),s.trackAddressRefineViewed(),!1):!!a||(s.props.geocodeAddressFromString({searchString:c}).then(function(){s.setState({isMapOpen:!0}),s.trackAddressRefineViewed()}),!1)}),(0,i.Z)((0,n.Z)(s),"handleLocationSearch",function(){var e=s.state.isMapOpen,t=s.props,o=t.searchType,n=t.searchFilter,a=t.brand,r=s.getLocationDetails();switch(s.trackSearchEvent(r),s.props.updateLocationDetails(r),s.setState({isLoading:!0,isMapOpen:!1}),o){case"restaurants":s.props.locationRestaurantSearch({location:r,filter:n}).then(s.navigateToRedirectUrl);break;case"brand":s.props.locationBrandSearch({location:r,brand:a}).then(s.navigateToRedirectUrl);break;case"basket":s.props.locationBasketSearch({location:r,isMapOpen:e})}}),(0,i.Z)((0,n.Z)(s),"isSearchingWithValidPostcode",function(){var e=s.props,t=e.isPostcodeSearch,o=e.countryHasPostcodes,n=e.tld,a=s.state.inputValue;return!!a&&!!(!t&&o&&(0,V.U)(a,n))});var s,c,u=(0,n.Z)(s);return(0,i.Z)((0,n.Z)(s),"onSubmit",(c=(0,a.Z)(function(e){var t,o;return(0,g.__generator)(this,function(o){switch(o.label){case 0:if(e&&e.preventDefault(),t="basket"===u.props.searchType,!u.state.isUndeliverable)return[3,1];return u.searchRestaurants(),[3,4];case 1:if(!(!t&&u.isSearchingWithValidPostcode()))return[3,3];return[4,u.props.geocodeAddressFromString({searchString:u.state.inputValue})];case 2:return o.sent(),u.handleLocationSearch(),[3,4];case 3:u.validateAddress()&&u.handleLocationSearch(),o.label=4;case 4:return[2]}})}),function(e){return c.apply(this,arguments)})),(0,i.Z)((0,n.Z)(s),"homepageSearchFilterMessage",function(e){var t=e.homepageSearchFilter,o=e.isPostcodeSearch;return O.Z.gettext("locationSearch.filterCaption.".concat(t.tags?"collection":"restaurant",".").concat(o?"postcode":"address","(%(name)s)"),{name:t.name})}),(0,i.Z)((0,n.Z)(s),"trackAddressRefineViewed",function(){s.props.trackAddressRefine({action:"Viewed",sourceView:s.props.trackingPage,lat:j()(function(){return s.props.coords.lat}),lng:j()(function(){return s.props.coords.lng}),postCode:s.props.postalCode,searchString:s.searchedTerm})}),(0,i.Z)((0,n.Z)(s),"renderLocationSearch",function(){var e,t=s.props,o=t.currentUrl,n=t.tld,a=t.caption,r=t.isPostcodeSearch,i=t.isLoggedIn,c=t.examplePostcode,u=t.userAddresses,p=t.homepageSearchFilter,g=t.suggestions,f=t.highlightedSuggestion,m=t.containerRef,S=t.showAlternativeCaption,v=t.isNewAddressFlow,b=t.isModalOpen,L=t.isModal,A=t.whiteLabelConfig,M=t.usePostcodeAsPlaceholder,Z=t.variant,C=t.hasDarkBackground,R=t.hasRoundedInput,x=t.isButtonInsideInput,k=t.buttonLabel,y=s.state,w=y.hasGeolocation,T=y.isLocating,F=y.isLoading,B=y.loadingAddressId,E=y.inputValue,N=y.errorMessage,j=L?void 0:null!=k?k:O.Z.gettext("locationSearch.searchButton.text"),V=r||M?O.Z.gettext("locationSearch.input.postcode.placeholder(%(postcode)s)",{postcode:c}):O.Z.gettext("locationSearch.input.formattedAddress.placeholder"),q=p.name?s.homepageSearchFilterMessage({isPostcodeSearch:r,homepageSearchFilter:p}):void 0,I=i?void 0:O.Z.gettext("locationSearch.loginMessage(%(linkUrl)s)"),D=A?(0,er.getWhiteLabelLoginLink)(A,n,o):"/login?redirect=".concat(encodeURI(o));switch(!0){case r&&S:e="locationSearch.input.postcode.labelAlternative";break;case r:e="locationSearch.input.postcode.label";break;case S:e="locationSearch.input.formattedAddress.labelAlternative";break;default:e="locationSearch.input.formattedAddress.label"}var _={hasCard:!s.props.isModal&&"default"===Z,hasGeolocation:w,value:E,inputRef:function(e){s.inputElement=e},containerRef:m,caption:a||O.Z.gettext(e),placeholder:V,errorMessage:N,searchFilterMessage:q,loginMessageTemplate:I,loginUrl:i?void 0:D,onFocus:s.onFocus,onBlur:s.onBlur,onChange:s.onChange,onKeyDown:s.onKeyDown,onLocateClick:s.onRequestGeolocation,onSubmit:s.onSubmit,buttonText:j,locateButtonLabel:O.Z.gettext("locationSearch.useGeolocation.label"),autoComplete:r?"postal-code":"off",savedAddressesCaption:O.Z.gettext("locationSearch.savedAddresses.label"),savedAddressLoadingId:B,savedAddresses:u,onAddressClick:s.onSavedAddressClick,isLocating:T,isLoading:F,suggestions:g,highlightedSuggestion:f,onSuggestionClick:s.onSuggestionClick,hasPoweredByDeliverooLogo:!L&&!!A,poweredByDeliverooAltText:O.Z.gettext("poweredByDeliveroo"),hasDarkBackground:C,hasRoundedInput:R,isButtonInsideInput:x};return v&&L&&b?(0,h.jsx)(J,(0,l.Z)((0,d.Z)({},_),{hasCard:!1,onModalClose:s.onModalClose,onClear:s.onClear})):(0,h.jsx)(P.Z,(0,d.Z)({},_))}),(0,i.Z)((0,n.Z)(s),"renderErrorMessage",function(){var e=s.props.isNewAddressFlow,t=s.state.errorMessage;return e&&t&&"string"==typeof t?(0,h.jsx)("div",{className:ey().errorMessage,children:(0,h.jsx)(w.default,{color:"red",spacing:"0 0 medium 0",children:t})}):null}),(0,i.Z)((0,n.Z)(s),"renderModalFooter",function(){var e=s.props,t=e.isLocationAccurate,o=e.isNewAddressFlow,n=e.loadingSuggestions,a=e.suggestions,r=s.state,i=r.isLoading,c=r.isMapOpen,d=r.isUndeliverable,l=r.inputValue,u=Boolean(a.length);return(0,h.jsxs)("div",{className:ey().buttonWrapper,children:[s.renderErrorMessage(),(0,h.jsxs)(T.default,{type:"primary",onClick:function(e){s.setState({pinRefined:!0},function(){return s.onSubmit(e)})},isDisabled:!d&&(c&&!t||o&&""===l),isLoading:i||n&&!u,isBlock:!0,children:[o&&c&&O.Z.gettext("locationSearch.mapModal.button.markLocation"),!o&&c&&(t?O.Z.gettext("locationSearch.mapModal.button.confirm"):O.Z.gettext("locationSearch.mapModal.button.refine")),!c&&(d?O.Z.gettext("locationSearch.viewPlacesNearby.text"):O.Z.gettext("locationSearch.searchButton.text"))]})]})}),(0,i.Z)((0,n.Z)(s),"renderMap",function(){var e=s.props,t=e.coords,o=e.isNewAddressFlow,n=s.state.inputValue,a={};return o&&(a={gestureHandling:"greedy",scrollwheel:!1,zoom:18,mapTypeControlOptions:{mapTypeIds:["roadmap","satellite"]},mapTypeId:"roadmap",mapTypeControl:!0}),(0,h.jsx)(F.Z,{label:O.Z.gettext("locationSearch.mapModal.formattedAddress.labelText"),formattedAddress:n,onMapMarkerChange:s.onMapMarkerChange,loadGoogleMapsApi:function(){return(0,es.e1)()},coords:t,hasFixedMapMarker:o,extraMapOptions:a,tooltipText:o?O.Z.gettext("locationSearch.mapModal.tooltipText"):void 0,icon:o?E.IconType.CUSTOMER:void 0})}),s.searchedTerm="",s.state={hasGeolocation:!1,isLocating:!1,isLoading:!1,isMapOpen:!1,isUndeliverable:!1,loadingAddressId:void 0,isValidPostcode:void 0,errorMessage:void 0,inputValue:e.initialInputValue||"",pinRefined:!1},s}return(0,s.Z)(o,[{key:"componentDidMount",value:function(){"geolocation"in navigator&&this.setState({hasGeolocation:!0})}},{key:"componentDidUpdate",value:function(e){var t=this.props,o=t.serviceError,n=t.serviceErrorMessage,a=t.formattedAddress,r=t.homepageSearchFilter,s=t.restaurantsRedirectLocation,i=t.searchType,c=t.hasInputFocus,p=t.isModalOpen,g=t.canBasketDeliverToLocation,h=e.serviceError,f=e.serviceErrorMessage,m=e.formattedAddress,S=e.restaurantsRedirectLocation,v=e.hasInputFocus;if(o!==h&&"NOT_SERVICED"===o&&this.props.showVoteAreaModal(),"brand"===i&&o!==h&&"UNDELIVERABLE"===o&&this.props.showUndeliverableModal(),"basket"===i){if(s!==S&&s&&this.navigateToRedirectUrl(),n!==f&&n)this.setState({isLoading:!1,isUndeliverable:"NOT_SERVICED"!==o,errorMessage:n});else if(g){var b=this.getLocationDetails(),L=new(k())(window.location.href,!0),M={};if(b.post_code)M=(0,l.Z)((0,d.Z)({},L.query),{post_code:b.post_code});else{var Z=(0,u.Z)(b.coordinates||[],2),C=Z[0],x=Z[1];M=(0,d.Z)({},L.query,void 0!==C&&void 0!==x&&{geohash:R().encode(x,C)})}L.set("query",M),window.location.href=L.toString()}}a!==m&&""!==a&&void 0!==a&&this.setState({inputValue:a}),(JSON.stringify(r)!==JSON.stringify(e.homepageSearchFilter)&&!A()(r,{menu_group_uname:void 0,name:void 0,tags:void 0})||c!==v&&c)&&this.onFocusSearch(),p&&this.inputElement&&!this.state.isMapOpen&&this.inputElement.focus()}},{key:"onFocusSearch",value:function(){var e=this;this.props.onFocusSearch().then(function(){e.inputElement&&e.inputElement.focus()})}},{key:"render",value:function(){var e=this.props,t=e.brandName,o=e.trackingPage,n=e.isModal,a=e.isModalOpen,r=e.searchType,s=e.withClickAndCollect,i=e.isNewAddressFlow,c=this.state.isMapOpen,u=O.Z.gettext("locationSearch.mapModal.headerTitle");i&&c?u=(0,h.jsxs)("div",{className:ey().modalHeading,children:[(0,h.jsx)(w.default,{isBold:!0,children:O.Z.gettext("locationSearch.modal.addressTitle")}),(0,h.jsx)(w.default,{size:"small",children:O.Z.gettext("locationSearch.modal.addressSubtitle")})]}):n&&(u=s?O.Z.gettext("locationSearch.modal.modalTitle"):O.Z.gettext("locationSearch.modal.headerTitle"));var p={appElement:"#__next",headerTitle:u,hasOverflow:n&&!c&&!i,closeButtonLabel:O.Z.gettext("closeButton.label"),renderFooter:this.renderModalFooter};return(0,h.jsxs)(f.Fragment,{children:[!n&&this.renderLocationSearch(),!n&&c&&(0,h.jsx)(B.Z,(0,l.Z)((0,d.Z)({},p),{isOpen:!0,onClose:this.onMapClose,children:this.renderMap()})),n&&a&&(0,h.jsxs)(B.Z,(0,l.Z)((0,d.Z)({},p),{isOpen:!0,onClose:this.onModalClose,children:[!c&&this.renderLocationSearch(),c&&this.renderMap()]})),(0,h.jsx)(ex,{page:o}),"brand"===r&&(0,h.jsx)(eh,{brandName:t})]})}}]),o}(f.Component),eP={menu_group_uname:S().string,name:S().string,tags:S().string};eT.propTypes={currentUrl:S().string.isRequired,tld:S().string.isRequired,isModal:S().bool,formattedAddress:S().string,placeId:S().string,coords:S().shape({lat:S().number,lng:S().number}),isLocationAccurate:S().bool,suggestions:S().arrayOf(S().shape({address:S().string.isRequired,formattedAddress:S().string,locality:S().string,placeId:S().string.isRequired})),hasInputFocus:S().bool,highlightedSuggestion:S().number,trackingPage:S().string.isRequired,isPostcodeSearch:S().bool.isRequired,examplePostcode:S().string,usePostcodeAsPlaceholder:S().bool,isLoggedIn:S().bool.isRequired,isNewAddressFlow:S().bool,withClickAndCollect:S().bool,caption:S().string,userAddresses:S().arrayOf(S().shape({id:S().string,formattedAddress:S().string,postcode:S().string,coordinates:S().arrayOf(S().number).isRequired})),updateLocationDetails:S().func.isRequired,searchType:S().oneOf(["restaurants","brand","basket"]),brand:(0,v.default)(S().string,function(e){return"brand"===e.searchType}),brandName:(0,v.default)(S().string,function(e){return"brand"===e.searchType}),locationRestaurantSearch:S().func.isRequired,locationBrandSearch:S().func.isRequired,locationBasketSearch:S().func.isRequired,restaurantsRedirectLocation:(0,v.default)(S().string,function(e){return"restaurants"===e.searchType}),menuRedirectLocation:(0,v.default)(S().string,function(e){return"brand"===e.searchType}),isModalOpen:S().bool,canBasketDeliverToLocation:S().bool,navigateToSavedAddress:S().func.isRequired,trackEnteredLocation:S().func.isRequired,trackSearchLocationChange:S().func.isRequired,trackLocationSearchRedirect:S().func.isRequired,hideLocationSearchModal:S().func.isRequired,clearLocationQuery:S().func.isRequired,changeHighlightedSuggestion:S().func.isRequired,locationFromGeolocation:S().func.isRequired,fetchAddressSuggestions:S().func.isRequired,clearAddressSuggestions:S().func.isRequired,selectAddressSuggestion:S().func.isRequired,trackPlacesSuggestions:S().func.isRequired,trackAddressRefine:S().func.isRequired,geocodeAddressFromString:S().func.isRequired,showVoteAreaModal:S().func.isRequired,focusLocationSearch:S().func.isRequired,showUndeliverableModal:S().func.isRequired,initialInputValue:S().string,onFocusSearch:S().func,onBlurSearch:S().func,searchFilter:S().shape(eP),homepageSearchFilter:S().shape(eP),serviceError:S().string,serviceErrorMessage:S().string,containerRef:S().func,showAlternativeCaption:S().bool,postalCode:S().string,loadingSuggestions:S().bool,countryHasPostcodes:S().bool.isRequired,whiteLabelConfig:S().oneOfType([S().bool,S().object]).isRequired,onSearch:S().func,variant:S().oneOf(["new","default"]),hasDarkBackground:S().bool,hasRoundedInput:S().bool,isButtonInsideInput:S().bool,buttonLabel:S().string},eT.defaultProps={isModal:!1,formattedAddress:void 0,placeId:void 0,coords:void 0,isLocationAccurate:void 0,suggestions:[],hasInputFocus:!1,highlightedSuggestion:void 0,caption:void 0,examplePostcode:void 0,usePostcodeAsPlaceholder:!1,isNewAddressFlow:!1,withClickAndCollect:!1,searchType:"restaurants",brand:void 0,brandName:void 0,restaurantsRedirectLocation:void 0,menuRedirectLocation:void 0,isModalOpen:!1,canBasketDeliverToLocation:!1,userAddresses:[],initialInputValue:void 0,onFocusSearch:function(){return new Promise(function(e){e()})},onBlurSearch:function(){},searchFilter:void 0,homepageSearchFilter:{},serviceError:void 0,serviceErrorMessage:void 0,containerRef:void 0,showAlternativeCaption:!1,postalCode:void 0,loadingSuggestions:!1,onSearch:void 0,variant:"default",hasDarkBackground:!1,hasRoundedInput:!1,isButtonInsideInput:!1,buttonLabel:void 0};var eF=function(e){var t=e.request.currentUrl,o=e.request.country,n=o.tld,a=o.examplePostcode,r=e.location.recentAddresses.locations,s=e.user.isLoggedIn,i=e.location.places,c=i.formattedAddress,d=i.placeId,l=i.coords,u=i.postalCode,p=i.suggestions,g=i.highlightedSuggestion,h=i.isLocationAccurate,f=i.loadingSuggestions,m=e.location.search,S=m.showModal,v=m.restaurantsRedirectLocation,b=m.menuRedirectLocation,L=m.canBasketDeliverToLocation,A=m.error,M=e.home.filters.location||{},Z=M.neighborhood,C=M.postcode,R=e.homepageFeaturedContent.filter||{},x=R.menu_group_uname,k=R.name,y=R.tags,w=(e.brands.current||{}).brand,T=(0,eo._u)(e),P=(0,eo.xk)(e);return{currentUrl:t,tld:n,isPostcodeSearch:T,examplePostcode:a,isLoggedIn:s,userAddresses:r.slice(0,ew),formattedAddress:c,placeId:d,coords:l,postalCode:u,isLocationAccurate:h,suggestions:p,highlightedSuggestion:g,restaurantsRedirectLocation:v,menuRedirectLocation:b,isModalOpen:S,isNewAddressFlow:P,brandName:w,withClickAndCollect:(0,et.dz)(e,ei.CO_CLICK_AND_COLLECT),initialInputValue:(0,V.s)({tld:n,isPostcodeSearch:T,postcode:C,neighborhood:Z}),homepageSearchFilter:{menu_group_uname:x,name:k,tags:y},canBasketDeliverToLocation:L,serviceError:A&&A.type||void 0,serviceErrorMessage:(null==A?void 0:A.message)||void 0,loadingSuggestions:f,countryHasPostcodes:(0,eo.Gg)(e)}},eB=function(e){return{updateLocationDetails:function(t){return e((0,en.dh)(t))},locationRestaurantSearch:function(t){return e((0,en.DI)(t))},locationBrandSearch:function(t){return e((0,en.o2)(t))},locationBasketSearch:function(t){return e((0,en._I)(t))},navigateToSavedAddress:function(t){return e((0,en.WC)(t))},trackEnteredLocation:function(){return e((0,ea.D)())},trackSearchLocationChange:function(t){return e((0,ea.N9)(t))},trackPlacesSuggestions:function(t){return e((0,ea.k7)(t))},trackAddressRefine:function(t){return e((0,ea.h9)(t))},hideLocationSearchModal:function(){return e((0,en.QQ)())},clearLocationQuery:function(){return e((0,en.dn)())},changeHighlightedSuggestion:function(t){var o=t.newSuggestion;return e((0,en.Xj)({newSuggestion:o}))},locationFromGeolocation:function(t){return e((0,en.qq)(t))},fetchAddressSuggestions:function(t){return e((0,en.TW)(t))},clearAddressSuggestions:function(){return e((0,en.PN)())},selectAddressSuggestion:function(t){return e((0,en.Dr)(t))},geocodeAddressFromString:function(t){return e((0,en.D$)(t))},focusLocationSearch:function(){return e((0,en.tn)())},showVoteAreaModal:function(){return e((0,ee.wT)())},showUndeliverableModal:function(){return e((0,en.Pi)())},trackLocationSearchRedirect:function(t,o){return e((0,ea.RK)(t,o))}}},eE=function(e,t,o){return(0,d.Z)({},e,t,o)},eO=(0,b.$j)(eF,eB,eE)((0,y.Z)(eT))},17119:function(e,t,o){"use strict";o.d(t,{U:function(){return r},s:function(){return s}});var n=o(55460),a={UK:/^(GIR0AA)|(((A[BL]|B[ABDFHLNRSTX]?|C[ABFHMORTVW]|D[ADEGHLNTY]|E[HNX]?|F[KY]|G[LUY]?|H[ADGPRSUX]|I[GMPV]|JE|K[ATWY]|L[ADELNSU]?|M[EKL]?|N[EGNPRW]?|O[LX]|P[AEHLOR]|R[GHM]|S[AEGKLMNOPRSTY]?|T[ADFNQRSW]|UB|W[ADFNRSV]|YO|ZE)[1-9]?[0-9]|((E|N|NW|SE|SW|W)1|EC[1-4]|WC[12])[A-HJKMNPR-Y]|(SW|W)([2-9]|[1-9][0-9])|EC[1-9][0-9])[0-9][ABD-HJLNP-UW-Z]{2})$/i,NL:/^[1-9][0-9]{3}\s?[a-zA-Z]{2}$/,BE:/^[0-9]{4}$/};function r(e,t){var o=a[t.toUpperCase()];return null!=e.replace(/\s+/g,"").match(o)}function s(e){var t=e.tld,o=e.isPostcodeSearch,a=e.postcode,r=e.neighborhood;switch(!0){case"uk"===t:return(0,n.ZI)(a)||"";case o:return a;default:return r}}},97898:function(e){e.exports={maxWidthMobile:"(max-width: 540px)",minWidthTablet:"(min-width: 540px)",minWidthDesktop:"(min-width: 960px)",minWidthLargeDesktop:"(min-width: 1440px)",minWidthXLargeDesktop:"(min-width: 1920px)",modalContentWrapper:"LocationSearchModalLayout-fc888dda82a8c5b3",innerContainer:"LocationSearchModalLayout-b202d0c3fdce00db",inputWrapper:"LocationSearchModalLayout-6504f4127b09b11b",searchForm:"LocationSearchModalLayout-fac1e8de7453ab7c",searchInput:"LocationSearchModalLayout-953fd91b2886fd63",inputButton:"LocationSearchModalLayout-cac5919a59c57583",savedAddressesContainer:"LocationSearchModalLayout-a120df33d0652ea2",suggestions:"LocationSearchModalLayout-dee2a53fe8bd027a",poweredByGoogle:"LocationSearchModalLayout-ebb39129af88c33f",login:"LocationSearchModalLayout-337d0109d53a2474"}},66926:function(e){e.exports={wrapper:"VoteAreaModal-0d43d938cfb9b11c",submitted:"VoteAreaModal-0750631ff39723d6",rider:"VoteAreaModal-026996f3912778ec",heading:"VoteAreaModal-58dabfc22dfedda0",confirmation:"VoteAreaModal-c726e2c61e2d4413"}},51135:function(e){e.exports={modalHeading:"LocationSearchContainer-fd7c212dba7df9f6",buttonWrapper:"LocationSearchContainer-a680ff4dd5094fe8",errorMessage:"LocationSearchContainer-e7c6df4849659d00"}}}]);
//# sourceMappingURL=8409-33afec2ca92dbdc3.js.map